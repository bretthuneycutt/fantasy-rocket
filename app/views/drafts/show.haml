.drafts-show.container.container-under-header
  .league-header
    %h1.league-name= @league.name
    .member-count #{@league.members.size} players
    .how-the-draft-works

  .current-pick{class: @draft.current_picker == current_user ? "your-turn" : ""}
    - if @draft.current_picker == current_user
      It's your turn! Pick a team to draft.
    - else
      / TODO - pluralize correctly
      It's #{@draft.current_picker.name}'s turn to pick.

  .draft-view-toggle.clearfix
    .toggle-button.drafted-button Picks
    .toggle-button.available-button Available

  %table.draft-table.table.drafted-view.hidden
    %thead
      %tr
        %th.pick-header Pick
        %th Team
    %tbody
      / TODO - move this logic out of view (e.g. into decorator)
      - shown_drafting_now = false
      - @draft.picks.each_with_index do |pick, i|
        - if !shown_drafting_now && !pick.team && pick.member == @draft.current_picker
          - should_show_drafting_now = true
          - shown_drafting_now = true
        %tr{class: should_show_drafting_now ? "drafting-now" : ""}
          %td.pick= i + 1
          %td.clearfix
            - if pick.team
              .team
                .team-icon{class: pick.team.css_class}
                .team-name= pick.team.name
            - elsif should_show_drafting_now
              .notification Drafting now!
            .member-name= pick.member.name

  %table.draft-table.table.available-view.hidden
    %thead
      %tr
        %th.rank-header= link_to "Exp. wins", "http://www.cbssports.com/nfl/writer/pat-kirwan/23268807/nfl-teambyteam-record-predictions", target: "_blank"
        %th Team
    %tbody
      - @draft.available_teams.each_with_index do |team, i|
        %tr.available-team
          %td.rank= team.expected_wins
          %td.clearfix
            .team
              .team-icon{class: team.css_class}
              .team-name= team.name
            - if current_user == @draft.current_picker
              = link_to "+ Pick", draft_pick_path(@draft.current_pick, team_id: team.id), method: "put", class: "btn btn-main pick-link"

:coffee
  $ ->
    new DraftView()
